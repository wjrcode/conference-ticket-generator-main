<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@200..900&family=Oswald:wght@200..700&display=swap"
    rel="stylesheet">

  <link rel="icon" type="image/png" sizes="32x32" href="./assets/images/favicon-32x32.png">

  <title>Frontend Mentor | Conference ticket generator</title>

  <style>
    .attribution {
      font-size: 11px;
      text-align: center;
    }

    .attribution a {
      color: hsl(7, 88%, 67%);
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="logo">
      <img src="./assets/images/logo-full.svg" alt="Coding Conf logo" />
    </div>
    <header>
      <h1>Your Journey to Coding Conf 2025 Starts Here!</h1>
      <p>Secure your spot at next year's biggest coding conference.</p>
    </header>
    <form id="form" name="form" novalidate onsubmit="return saveFormData()">
      <label for="avatar" calss="input-file">Upload Avatar</label>
      <div class="file-input" onclick="selectImage()" id="file-input" tabindex="0">
        <div class="upload-button" id="upload-button"><img src="./assets/images/icon-upload.svg" alt="Upload button">
        </div>
        <input required type="file" id="avatar" name="avatar" accept="image/png, image/gif, image/jpeg"
          onchange="avatarValidation()">
        <p id="atavar-text">Drag and drop or click to upload</p>
      </div>
      <div class="file-input--filled hide" id="file-input--filled">
        <img id="avatar-photo" src="#" alt="class" />
        <div class="avatar-actions" id="avatar-actions">
          <button type="button" onclick="removeAvatar()">Remove Image</button>
          <button type="button" onclick="selectImage()">Change Image</button>
        </div>
      </div>
      <span class="input-message" id="message-error-avatar-empty">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16">
          <path path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M2 8a6 6 0 1 0 12 0A6 6 0 0 0 2 8Z" />
          <path stroke=var(--color) fill="#D1D0D5" d="M8.004 10.462V7.596ZM8 5.57v-.042Z" />
          <path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M8.004 10.462V7.596M8 5.569v-.042" />
        </svg>
        <p>Upload your photo (JPG or PNG, max size: 500KB).</p>
      </span>
      <span class="input-message hide" id="message-error-avatar">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16">
          <path path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M2 8a6 6 0 1 0 12 0A6 6 0 0 0 2 8Z" />
          <path stroke=var(--color) fill="#D1D0D5" d="M8.004 10.462V7.596ZM8 5.57v-.042Z" />
          <path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M8.004 10.462V7.596M8 5.569v-.042" />
        </svg>
        <p>File too large. Please upload a photo under 500kb.</p>
      </span>
      <label for="name">Full Name</label>
      <input required type="text" id="name" name="name">
      <div class="input-message hide" id="message-error-name">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16">
          <path path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M2 8a6 6 0 1 0 12 0A6 6 0 0 0 2 8Z" />
          <path stroke=var(--color) fill="#D1D0D5" d="M8.004 10.462V7.596ZM8 5.57v-.042Z" />
          <path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M8.004 10.462V7.596M8 5.569v-.042" />
        </svg>
        <p>Please enter your full name.</p>
      </div>
      <label for="email">Email Address</label>
      <input required type="text" id="email" name="email" placeholder="example@email.com">
      <span class="input-message hide" aria-live="polite" id="message-error-email">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16">
          <path path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M2 8a6 6 0 1 0 12 0A6 6 0 0 0 2 8Z" />
          <path stroke=var(--color) fill="#D1D0D5" d="M8.004 10.462V7.596ZM8 5.57v-.042Z" />
          <path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M8.004 10.462V7.596M8 5.569v-.042" />
        </svg>
        <p>Please enter a valid email address.</p>
      </span>
      <label for="github">GitHub Username</label><br>
      <input required type="text" id="github" name="github" placeholder="@yourusername">
      <span class="input-message hide" id="message-error-github">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16">
          <path path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M2 8a6 6 0 1 0 12 0A6 6 0 0 0 2 8Z" />
          <path stroke=var(--color) fill="#D1D0D5" d="M8.004 10.462V7.596ZM8 5.57v-.042Z" />
          <path stroke=var(--color) stroke-linecap="round" stroke-linejoin="round"
            d="M8.004 10.462V7.596M8 5.569v-.042" />
        </svg>
        <p>Please enter your GitHub Username.</p>
      </span>
      <input type="submit" value="Generate My Ticket">
    </form>

    <div class="attribution">
      Challenge by <a href="https://www.frontendmentor.io?ref=challenge">Frontend Mentor</a>.
      Coded by <a href="#">Willian Pinheiro Jr</a>.
    </div>
  </div>
</body>

<script>
  const form = document.getElementById("form");

  function saveFormData() {

    if (form.avatar.validity.valueMissing) {
      showError(document.getElementById("message-error-avatar-empty"));
      return false;
    }
    else {
      hideError(document.getElementById("message-error-avatar-empty"));
    }

    if (form.name.validity.valueMissing) {
      showError(document.getElementById("message-error-name"));
      return false;
    }
    else {
      hideError(document.getElementById("message-error-name"));
    }

    if (!form.email.validity.valid) {
      showError(document.getElementById("message-error-email"));
      return false;
    } else {
      hideError(document.getElementById("message-error-email"));
    }

    if (form.github.validity.valueMissing) {
      showError(document.getElementById("message-error-github"));
      return false;
    }
    else {
      hideError(document.getElementById("message-error-github"));
    }

    localStorage.setItem('name', form.name.value);
    localStorage.setItem('email', form.email.value);
    localStorage.setItem('github', form.github.value);

    event.preventDefault();

    window.location.replace('/conference-ticket-generator-main/ticket-page.html');
  }

  function showError(error) {
    error.classList.add("active", "orange");
  }

  function hideError(error) {
    error.classList.remove("active", "orange");
  }

  selectImage = () => {
    document.getElementById('avatar').click();
  }

  removeAvatar = () => {
    document.getElementById('avatar').value = '';
    document.getElementById("file-input--filled").classList.add("hide");
    document.getElementById("file-input").classList.remove("hide");
  }

  avatarValidation = () => {
    const fi = document.getElementById('avatar');

    if (fi.files.length > 0) {
      for (var i = 0; i <= fi.files.length - 1; i++) {

        const fsize = fi.files.item(i).size;
        const file = Math.round((fsize / 1024));

        if (file > 500) {
          showError(document.getElementById("message-error-avatar"));
          document.getElementById("message-error-avatar-empty").classList.add("hide");
        }
        else {
          hideError(document.getElementById("message-error-avatar"));
          document.getElementById("message-error-avatar-empty").classList.remove("hide");
          readURL(fi)
          document.getElementById("file-input--filled").classList.remove("hide");
          document.getElementById("file-input").classList.add("hide");
        }
      }
    }
  }

  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();

      reader.onload = function (e) {
        document.getElementById("avatar-photo").setAttribute('src', e.target.result);
        localStorage.setItem('avatar', e.target.result);
      }

      reader.readAsDataURL(input.files[0]);
    }
  }

</script>
</html>